STK.register("kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b,c){var d=a.core.util.language(b,$LANG);d=d.replace(/\\}/ig,"}");if(c){d=a.templet(d,c)}return d}});if(typeof scope==="undefined"){scope={}}scope.loginKit=function(){var b=document.cookie+";";var f=["SUP","=([^;]*)?;"].join("");var a=["(\\?|&)","uid","=([^&]*)(&|$)"].join("");var e=b.match(new RegExp(f,"i"));e=(e)?e[1]||"":"";e=unescape(e);var c=e.match(new RegExp(a));c=(c)?c[2]||"":"";var d=scope["$oid"];return{uid:c,isLogin:!!c,isAdmin:c&&d&&(c==d)}};scope.$isLogin=function(){return scope.loginKit().isLogin};scope.$isAdmin=function(){return scope.loginKit().isAdmin};STK.register("common.widget.login",function(c){var b={vsrc:"app_weiboshow",appsrc:"",showlogo:0,callback:function(){}};if(typeof App==="undefined"){App={}}var a={app_livestream:4,app_listweibo:5,app_weiboshow:6};return function(g){g=c.parseParam(b,g);if(!g.appsrc){g.appsrc=scope?(scope.appsrc?scope.appsrc:(scope.$appsrc?scope.$appsrc:"")):""}var f={};App.loginBackUrlCallBack=function(o){c.custEvent.fire(f,"login",o);var m=scope.refer||scope.$refer||"";var q="log_"+(+new Date);var p=window[q]=new Image();p.onload=(p.onerror=function(){window[q]=null});var l=scope.loginKit().uid;var k=a[g.vsrc]||"";p.src="http://rs.sinajs.cn/r.gif?uid="+l+"&appid="+($CONFIG.$appkey||$CONFIG.appkey||scope.appkey||0)+"&refer="+m+"&cat="+k;p=null};var j=function(){h();d();i();e()};var h=function(){};var d=function(){};var i=function(){c.custEvent.define(f,"login")};var e=function(){c.custEvent.add(f,"login",function(k){g.callback(k)})};f.showLogin=function(){var m="&"+c.jsonToQuery(g);var l="http://service.weibo.com/reg/loginindex.php?regbackurl=http%3A%2F%2Fweibo.com&backurl=http%3A%2F%2F"+location.host+"%2Fstaticjs%2FloginProxy.html"+m+"&rnd="+(+new Date().valueOf());if(/weibo.com/.test(location.host)){l=l.replace(/\/widget/,"")}var k=window.open(l,"miniblog_login",["toolbar=1,status=0,resizable=1,width=620,height=540,left=",(screen.width-620)/2,",top=",(screen.height-450)/2].join(""));k.focus()};j();return f}});STK.register("module.layer",function(b){var c=function(e){var d={};if(e.style.display=="none"){e.style.visibility="hidden";e.style.display="";d.w=e.offsetWidth;d.h=e.offsetHeight;e.style.display="none";e.style.visibility="visible"}else{d.w=e.offsetWidth;d.h=e.offsetHeight}return d};var a=function(g,f){f=f||"topleft";var e=null;if(g.style.display=="none"){g.style.visibility="hidden";g.style.display="";e=b.core.dom.position(g);g.style.display="none";g.style.visibility="visible"}else{e=b.core.dom.position(g)}if(f!=="topleft"){var d=c(g);if(f==="topright"){e.l=e.l+d.w}else{if(f==="bottomleft"){e.t=e.t+d.h}else{if(f==="bottomright"){e.l=e.l+d.w;e.t=e.t+d.h}}}}return e};return function(h){var k=b.core.dom.builder(h);var g=k.list.outer[0],e=k.list.inner[0];var j=b.core.dom.uniqueID(g);var i={};var d=b.core.evt.custEvent.define(i,"show");b.core.evt.custEvent.define(d,"hide");var f=null;i.show=function(){g.style.display="";b.core.evt.custEvent.fire(d,"show");return i};i.hide=function(){g.style.display="none";b.custEvent.fire(d,"hide");return i};i.getPosition=function(l){return a(g,l)};i.getSize=function(l){if(l||!f){f=c.apply(i,[g])}return f};i.html=function(l){if(l!==undefined){e.innerHTML=l}return e.innerHTML};i.text=function(l){if(text!==undefined){e.innerHTML=b.core.str.encodeHTML(l)}return b.core.str.decodeHTML(e.innerHTML)};i.appendChild=function(l){e.appendChild(l);return i};i.getUniqueID=function(){return j};i.getOuter=function(){return g};i.getInner=function(){return e};i.getParentNode=function(){return g.parentNode};i.getDomList=function(){return k.list};i.getDomListByKey=function(l){return k.list[l]};i.getDom=function(m,l){if(!k.list[m]){return false}return k.list[m][l||0]};i.getCascadeDom=function(m,l){if(!k.list[m]){return false}return b.core.dom.cascadeNode(k.list[m][l||0])};return i}});STK.register("ui.tipPrototype",function(a){var b=10003;return function(d){var e,i,h,g,c;var f='<div node-type="outer" class="WB_widgets W_layer" style="position: absolute; display:none;" ><div node-type="inner" class="bg"></div></div>';e=a.parseParam({direct:"up",showCallback:a.core.func.empty,hideCallback:a.core.func.empty},d);i=a.module.layer(f,e);h=i.getOuter();g=i.getInner();i.setTipWH=function(){c=this.getSize(true);this.tipWidth=c.w;this.tipHeight=c.h;return this};i.setTipWH();i.setContent=function(j){if(typeof j=="string"){g.innerHTML=j}else{g.appendChild(j)}this.setTipWH();return this};i.setLayerXY=function(p){if(!p){throw"ui.tipPrototype need pNode as first parameter to set tip position"}var q=STK.core.dom.position(p);var l=q.l;var o=p.offsetWidth;var k=p.offsetHeight;var n=Math.min(Math.max((l+(o-this.tipWidth)/2),a.scrollPos().left),(a.scrollPos().left+STK.winSize().width)-this.tipWidth);var m=q.t;if(e.direct==="down"){m+=k}var j=[";"];j.push("z-index:",(b++),";");j.push("width:",this.tipWidth,"px;");j.push("height:",this.tipHeight,"px;");j.push("top:",m,"px;");j.push("left:",n,"px;");h.style.cssText+=j.join("")};i.aniShow=function(){var k=this.getOuter();k.style.height="0px";k.style.display="";var j=a.core.ani.tween(k,{end:e.showCallback,duration:250,animationType:"easeoutcubic"});if(e.direct==="down"){j.play({height:this.tipHeight},{staticStyle:"overflow:hidden;position:absolute;"})}else{var l=(parseInt(k.style.top,10)-this.tipHeight);j.play({height:this.tipHeight,top:Math.max(l,a.scrollPos().top)},{staticStyle:"overflow:hidden;position:absolute;"})}};i.anihide=function(){var k=this.getOuter();var m=this;var j=a.core.ani.tween(k,{end:function(){k.style.display="none";k.style.height=m.tipHeight+"px";e.hideCallback()},duration:300,animationType:"easeoutcubic"});if(e.direct==="down"){j.play({height:0},{staticStyle:"overflow:hidden;position:absolute;"})}else{var l=(parseInt(k.style.top,10)+this.tipHeight);j.play({height:0,top:l},{staticStyle:"overflow:hidden;position:absolute;"})}};document.body.appendChild(h);i.destroy=function(){document.body.removeChild(h);i=null};return i}});STK.register("ui.tipAlert",function(a){var b=a.core.util.easyTemplate;return function(c){c=a.parseParam({direct:"up",className:"WB_widgets W_layer",showCallback:a.core.func.empty,hideCallback:a.core.func.empty,template:'<#et temp data><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td><div node-type="msgDiv" class="content layer_mini_info"><p class="clearfix alt_text"><span class="tip_icon WB_tipS_${data.type}"></span>${data.msg}&nbsp; &nbsp; &nbsp; </p></div></td></tr></tbody></table></#et>',type:"ok",msg:""},c);var g=a.ui.tipPrototype(c);var h=g.getInner();var e=g.getOuter();e.className=c.className;h.className="bg";var f=c.template;var i=a.builder(b(f,{type:c.type,msg:c.msg}).toString());g.setContent(i.box);var d=g.destroy;g.destroy=function(){d();g=null};return g}});STK.register("common.widget.reg",function(c){var a=c.kit.extra.language;var b=c.ui.tipAlert({className:"WB_tips_top",showCallback:function(){var d=b.getOuter();d.style.height="";d=null},template:'<#et temp data><div class="tips_inner"><span class="WB_tipS_warn"></span><span class="WB_icon_txt">'+a("#L{您的帐号尚未开通微博，}")+'<a href="#">'+a("#L{立即开通}")+"</a></span></#et>"});return function(d){if(!c.isNode(d)){throw"[common.widget.reg] need node as first parameter"}b.setLayerXY(d);b.aniShow();return b}});STK.register("common.widget.addFollow",function(d){var c=d.kit.extra.language;var b=function(){},a={uid:scope.loginKit().uid,url:"",fuid:"",appsrc:"",vsrc:"app_weiboshow",success:b,fail:b};var f;var e=function(g){if(g.fuid===g.uid){f.parentNode.innerHTML=c('<span class="WB_btnC"><span><em class="WB_btnicn_ok"></em><em>#L{你自己}</em></span></span>');return"yourself"}if(!g.url){g.url="/widget/weiboshow/aj_attention.php";if(/weibo.com/.test(location.host)){g.url="/weiboshow/aj_attention.php"}}d.ajax({method:"post",url:g.url,args:{uid:g.uid,fuid:g.fuid},onComplete:function(i){switch(i.code){case"A00006":break;case"A10007":break;case -1:d.common.widget.reg(f);break;case -2:var h=d.common.widget.login();d.custEvent.add(h,"login",function(){g.uid=scope.loginKit().uid;e(g)});h.showLogin();break;case -3:break}if((i.code=="A00006"||i.code=="A10007")&&f){f.parentNode.innerHTML=c('<span class="WB_btnC"><span><em class="WB_btnicn_ok"></em><em>#L{已关注}</em></span></span>')}typeof g.success==="function"&&g.success(i)},onFail:function(h){typeof g.fail==="function"&&g.fail(h)}})};return function(l,k){if(!l){throw"[common.widget.addFollow] need node as parameter";return}f=l;var h=function(){if(!scope.$isLogin()){var n=d.common.widget.login();d.custEvent.add(n,"login",function(){k.uid=scope.loginKit().uid;e(k)});n.showLogin();return}e(k)};var j={};var m=function(){k=d.parseParam(a,k);if(!k.fuid){k.fuid=l.getAttribute("uid")}g()};var g=function(){d.addEvent(l,"click",h)};var i=function(){d.removeEvent(l,"click",h)};j.destroy=i;m();return j}});STK.register("comp.widget.show.error",function(g){var f=g.addEvent,e=g.E("showTXA"),b=g.E("showTX"),a=g.E("showBtn");var d=g.kit.extra.language,c;return function(){var j={};if(!e){return j}var k=function(){a.style.display="none";b.style.display="block"};var h=function(){var m=g.E("txContent").value;var l="/widget/weiboshow/aj_addmblog.php";if(/weibo.com/.test(location.host)){l="/weiboshow/aj_addmblog.php"}g.ajax({url:l,args:{appkey:$CONFIG.$appsrc,content:encodeURIComponent(m)},method:"post",onComplete:function(o){var p=o.code;switch(p){case"A00006":g.E("showTX").innerHTML=d("#L{提醒成功，辛苦了}");break;case"M01155":alert(d("#L{你刚才好像提醒一次了}"));break;case"M00005":var n=g.common.widget.login();n.showLogin();break;case"M00004":alert(d("#L{参数错误}"));break;case"M00006":alert(d("#L{你未开通新浪微博。}"));break;case"M18003":alert(d("#L{提醒失败}"));break;default:alert(d("#L{提醒失败}"));break}}})};f(e,"click",k);f(g.E("txBtn"),"click",h);var i=function(){g.removeEvent(e,"click",k);g.removeEvent(g.E("txBtn"),"click",h)};j.destroy=i;return j}});STK.register("comp.widget.show.scroll",function(f){var i,m;var o=location.search;var a=f.E("weibo_list_con"),g=f.E("weibo_list"),d=f.E("fans_list_con");var j=f.core,e=j.evt.addEvent,k=j.evt.getEvent,p=j.evt.fireEvent,c=j.evt.stopEvent,n=j.arr.foreach;var b=function(){};var h=null,l=0;m={autoScroll:function(r,s){var s=s||5;var q=g.offsetHeight-a.clientHeight;clearInterval(this._timer);var t=setInterval(function(){if(!m.isOutRange){return}if(m.lock){return}var u=a.scrollTop;u=r=="down"?Math.min(u+2,q):Math.max(u-2,0);a.scrollTop=u;if(u==0||u==q){m.stop(t)}},s)},start:function(r,s){m.lock=true;var s=s||5;var q=g.offsetHeight-a.clientHeight;clearInterval(this._timer);this._timer=setInterval(function(){var t=a.scrollTop;t=r==="down"?Math.min(t+2,q):Math.max(t-2,0);a.scrollTop=t;if(t==0||t==q){m.stop()}},s)},lock:false,isOutRange:true,scroll:function(s){clearTimeout(this.ctimer);if(m.isOutRange){return}var r=a.scrollTop;var q=g.offsetHeight-a.clientHeight;r=(s.wheelDelta<=0||s.detail>0)?Math.min(r+20,q):Math.max(r-20,0);a.scrollTop=r;if(r==0||r==q){b();return}c(s);this.ctimer=setTimeout(function(){b()},500)},stop:function(q){clearInterval(q||this._timer);m.lock=false;b()}};i=function(){if(!f.E("weibo_con")||f.E("weibo_con").style.display=="none"){return}a.style.position="relative";a.scrollTop=0;l=g.offsetTop;h=f.sizzle(".weiboShow_mainFeed_list",a);(function(){var r=f.E("weibo_upbtn");if(!r){return}r=r.getElementsByTagName("em")[0];var u=f.E("weibo_downbtn").getElementsByTagName("em")[0];function s(){var w=a.scrollTop;var v=parseInt(a.style.height);r.style.display=(w==0?"none":"");u.style.display=(w+v==g.offsetHeight?"none":"")}var t=null;b=function(){clearTimeout(t);setTimeout(s,200)}})();b();if(h.length==0){return}(function(){var r=null;f.addEvent(a,"mouseover",function(){clearTimeout(r);m.isOutRange=false});f.addEvent(a,"mouseout",function(s){clearTimeout(r);r=setTimeout(function(){m.isOutRange=true},50)})})();try{window.addEventListener("DOMMouseScroll",function(r){m.scroll(r||event)},false)}catch(q){document.onmousewheel=function(r){m.scroll(r||event)}}n(["up","down"],function(r,s){e(f.E("weibo_"+r+"btn"),"mouseover",function(){m.start(r)});e(f.E("weibo_"+r+"btn"),"mouseout",function(){m.stop()})});n(h,function(r,s){e(r,"click",function(){c();window.open(r.getAttribute("gosrc"))})});(function(){var s=/speed=(\d+)/.test(o)?RegExp.$1:0;if(s==0){return}var r=g.offsetHeight-a.clientHeight;a.scrollTop=r;m.autoScroll("up",+s);setTimeout(function(){b()},+s)})()};return function(){return{init_scroll:i,autoScroll:m}}});STK.register("comp.widget.show.style",function(h){var i=h.core,f=i.evt.addEvent,j=i.evt.getEvent,b=i.str.trim,o=i.evt.reomveEvent,n=i.dom.sizzle,k=i.arr.foreach,m=i.evt.fireEvent,c=i.evt.stopEvent;var a=h.E("weibo_list_con"),g=h.E("weibo_list"),d=h.E("fans_list_con");var l=location.search;var e;(function(){var q=false;e=function(t){var s=document.createElement("style");s.type="text/css";if(h.IE){s.styleSheet.cssText=t}else{var u=document.createDocumentFragment();u.appendChild(document.createTextNode(t));s.appendChild(u)}function r(){document.getElementsByTagName("head")[0].appendChild(s)}r()}})();var p=function(){var s=/colors=([A-Fa-f\d,]+)/.test(l)?RegExp.$1:"";if(s){s=s.split(",");var F="";if(s[0]){F+=".weiboShow .weiboShow_topborder, .weiboShow .weiboShow_title {background:#"+s[0]+";}\n"}if(s[1]){F+=".weiboShow .weiboShow_wrap { background:#"+s[1]+" }\n"}if(s[2]){F+=".weiboShow { color:#666;}\n .weiboShow .weiboShow_developerDetail_namedir {color:#"+s[2]+" }\n"}if(s[3]){F+=".weiboShow a,\n .weiboShow .WB_linkA a,\n.weiboShow .WB_linkA, \n.weiboShow .WB_linkB a,\n.weiboShow .WB_linkB {color:#"+s[3]+" }"}if(s[4]){F+=".weiboShow .weiboShow_mainFeed_list:hover, .weiboShow .weiboShow_mainFeed_list_focus{background:#"+s[4]+" ;}"}e(F)}var G=/noborder=(\d+)/.test(l)?RegExp.$1:1;if(G==0){h.E("pl_weibo_show").className="WB_widgets weiboShow weiboShow_noborder"}try{var x={};x.fansRow=/fansRow=(\d+)/.test(l)?RegExp.$1:2;x.isTitle=h.E("weibo_title")?1:0;x.isFans=d?1:0;x.isWeibo=h.E("weibo_con")?1:0;x.height=parseInt(h.E("pl_weibo_show").style.height,10);x.width=h.E("pl_weibo_show").offsetWidth}catch(A){}var D=x.height-12;if(x.isTitle==1){D-=30}if(h.E("weibo_head")){D-=86}if(D<0){return}if(x.isFans){var B=n("li",d);var H=0;if(B.length==0){H=d.offsetHeight}else{var v=d.getElementsByTagName("ul")[0];var E=x.width;var u=Math.floor((E-11)/66);if(u==0){u=1}var C="0 "+((E-16-u*66)/2)+"px";try{v.style.padding=C}catch(A){var z=h.core.dom.cssText(v.style.cssText);z.push("padding",C);v.style.cssText=z.getCss()}var q=Math.ceil(B.length/u);x.fansRow=Math.min(x.fansRow,q,(((D-30)/84)>>0)||1);H=x.fansRow*84;if(H>0){H-=12}H+=30;if(H>=D){H=D}d.style.height=parseInt(H-3)+"px"}D-=H}if(x.isWeibo){if(D<32){h.E("weibo_con").style.display="none";return}try{var t=null;var y=function(){var w=g.offsetHeight;t&&clearInterval(t);if(w>0){var r;if(h.sizzle(".weiboShow_main_errorBox").length){r=(D-20>w?D-20:w)+"px";g.style.height=r}else{r=(D-20>w?w:D-20)+"px"}a.style.height=r}else{t=setInterval(y,500)}};y()}catch(A){}}};return p});if(typeof App==="undefined"){App={}}if(typeof scope==="undefined"){scope=$CONFIG}STK.register("comp.widget.show.init",function(h){var s=h.core,l=s.evt.addEvent,e=s.evt.getEvent,o=s.str.trim,f=s.evt.reomveEvent,c=s.dom.sizzle,j=s.io.ajax,d=s.arr.foreach,r=s.evt.fireEvent,p=s.evt.stopEvent,k=h.kit.extra.language;var q=h.comp.widget.show.scroll();var a=q.init_scroll,g=q.autoScroll;var b=location.search;var i=h.E("weibo_list_con"),m=h.E("weibo_list"),n=h.E("fans_list_con");return function(x,w){var v={};var y=function(){h.comp.widget.show.style();a();t()};var t=function(){var z=h.E("followBtn");z&&h.common.widget.addFollow(z,{uid:scope.$uid});h.comp.widget.show.error()};var u=function(){d(["up","down"],function(z,A){removeEvent(h.E("weibo_"+z+"btn"),"mouseover",function(){g.start(z)});removeEvent(h.E("weibo_"+z+"btn"),"mouseout",function(){g.stop()})})};y();v.destroy=u;return v}});STK.pageletM.register("pl.widget.show",function(d){try{var c={};var b=d.E("pl_weibo_show");var a=d.comp.widget.show.init(b,c);return a}catch(f){throw new Error(f.message)}});STK.pageletM.start();
